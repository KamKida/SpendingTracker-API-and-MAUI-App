<?xml version="1.0" encoding="utf-8" ?>
<ContentPage 
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:local="clr-namespace:SpendingTrackerApp.Pages.FundsPages"
    x:Class="SpendingTrackerApp.Pages.FundsPages.EditFundPage"
    xmlns:converters="clr-namespace:SpendingTrackerApp.Converters"
    Title="Edytuj fundusz">

	<ContentPage.Resources>
		<ResourceDictionary>
			<converters:DecimalNullableConverter 
                x:Key="DecimalNullableConverter" />
		</ResourceDictionary>
	</ContentPage.Resources>

	<Grid 
        InputTransparent="{Binding BlockInteraction}">

		<ScrollView>
			<Grid>
				<Grid 
                    RowDefinitions="Auto, Auto, Auto" 
                    ColumnDefinitions="*, *" 
                    Padding="20" 
                    RowSpacing="20">

					<Border 
                        Grid.Row="0" 
                        Grid.ColumnSpan="2">

						<Grid 
                            RowDefinitions="Auto, Auto, Auto, Auto, Auto, Auto, Auto, Auto, Auto, Auto, Auto, Auto, Auto, Auto"
                            ColumnDefinitions="Auto, *"
                            ColumnSpacing="20"
                            RowSpacing="20">

							<Label 
                                Grid.Row="0" 
                                Grid.Column="0" 
                                Grid.ColumnSpan="2" 
                                Text="Obecnie:" 
                                FontSize="33" />

							<ScrollView 
                                Grid.Row="1" 
                                Grid.Column="0" 
                                Grid.ColumnSpan="2" 
                                Orientation="Horizontal" 
                                HorizontalOptions="End" 
                                Margin="0,0,25,0">

								<Label 
                                    Text="{Binding Fund.Amount}" 
                                    FontSize="33" 
                                    HorizontalTextAlignment="End" />
							</ScrollView>

							<Label 
                                Grid.Row="3" 
                                Grid.Column="0" 
                                Text="Zł." 
                                FontSize="35" 
                                VerticalOptions="Center" 
                                HorizontalOptions="Start" 
                                TextColor="{StaticResource Positive}" />

							<ScrollView 
                                Grid.Row="3" 
                                Grid.Column="1" 
                                Orientation="Horizontal">

								<Entry 
                                    Text="{Binding FundRequest.Amount, Mode=TwoWay, Converter={StaticResource DecimalNullableConverter}}"
                                    Placeholder="00.00"
                                    HorizontalTextAlignment="End"
                                    HorizontalOptions="Center"
                                    VerticalOptions="Center"
                                    Keyboard="Numeric"
                                    FontSize="35"
                                    TextColor="{Binding AmountEntryColor}"
                                    BackgroundColor="Transparent" />
							</ScrollView>

							<Label 
                                Grid.Row="4" 
                                Grid.Column="0" 
                                Grid.ColumnSpan="2" 
                                Text="Kategoria:" 
                                FontSize="35" />

							<ScrollView 
                                Grid.Row="5" 
                                Grid.Column="0" 
                                Grid.ColumnSpan="2" 
                                Orientation="Horizontal" 
                                HorizontalOptions="End">

								<Label 
                                    Text="{Binding FundCategoryRequest.Name, TargetNullValue='Brak'}" 
                                    FontSize="35" />
							</ScrollView>

							<Label 
                                Grid.Row="6" 
                                Grid.Column="0" 
                                Grid.ColumnSpan="2" 
                                Text="Powinno być:" 
                                FontSize="35" />

							<ScrollView 
                                Grid.Row="7" 
                                Grid.Column="0" 
                                Grid.ColumnSpan="2" 
                                Orientation="Horizontal" 
                                HorizontalOptions="End">

								<Label 
                                    Text="{Binding FundCategoryRequest.ShouldBe, TargetNullValue='Brak'}" 
                                    FontSize="35" />
							</ScrollView>

							<Label 
                                Grid.Row="8" 
                                Grid.Column="0" 
                                Grid.ColumnSpan="2" 
                                Text="Różnica:" 
                                FontSize="35" />

							<ScrollView 
                                Grid.Row="9" 
                                Grid.Column="0" 
                                Grid.ColumnSpan="2" 
                                Orientation="Horizontal" 
                                HorizontalOptions="End">

								<Label 
                                    Text="{Binding FundDifference}" 
                                    FontSize="35" 
                                    TextColor="{Binding DifferenceColor}" />
							</ScrollView>

							<Button 
                                Grid.Row="10" 
                                Grid.Column="0" 
                                Grid.ColumnSpan="2" 
                                HorizontalOptions="Start" 
                                WidthRequest="150" 
                                VerticalOptions="Center" 
                                Margin="0,20,0,0" 
                                Text="Zmień" 
                                Command="{Binding ShowCategoryListCommand}" />

							<Button 
                                Grid.Row="11" 
                                Grid.Column="0" 
                                Grid.ColumnSpan="2" 
                                HorizontalOptions="Start" 
                                WidthRequest="150" 
                                VerticalOptions="Center" 
                                Margin="0,20,0,0" 
                                Text="Usuń" 
                                BackgroundColor="{StaticResource Negative}" 
                                Command="{Binding DeleteCategoryCommand}" />

							<Label 
                                Grid.Row="12" 
                                Grid.ColumnSpan="2" 
                                Text="Opis:" 
                                FontSize="35" />

							<Border 
                                Grid.Row="13" 
                                Grid.ColumnSpan="2" 
                                Background="White">

								<Grid 
                                    RowDefinitions="Auto, Auto" 
                                    ColumnDefinitions="*, Auto, Auto">

									<Editor 
                                        Grid.Row="0" 
                                        Grid.ColumnSpan="3" 
                                        AutoSize="Disabled" 
                                        HeightRequest="240" 
                                        FontSize="20" 
                                        VerticalOptions="Start"
                                        MaxLength="150"
                                        Text="{Binding Description}" />

									<Label 
                                        Grid.Row="1" 
                                        Grid.Column="1" 
                                        Text="{Binding DescriptionCount}" 
                                        TextColor="{StaticResource Primary}" />

									<Label 
                                        Grid.Row="1" 
                                        Grid.Column="2" 
                                        Text="/150" 
                                        TextColor="{StaticResource Primary}" />
								</Grid>
							</Border>

						</Grid>
					</Border>

					<Border 
                        Grid.Row="1" 
                        Grid.ColumnSpan="2" 
                        Background="White" 
                        Padding="10">

						<Label 
                            Text="{Binding Message}" 
                            TextColor="{Binding MessageColor}" 
                            LineBreakMode="WordWrap" />
					</Border>

					<Button 
                        Grid.Row="2" 
                        Grid.Column="0" 
                        WidthRequest="150" 
                        VerticalOptions="Center" 
                        Margin="0,20,0,0" 
                        Text="Zapisz" 
                        BackgroundColor="{StaticResource Positive}" 
                        Command="{Binding EditFundCommand}" />

					<Button 
                        Grid.Row="2" 
                        Grid.Column="1" 
                        WidthRequest="150" 
                        VerticalOptions="Center" 
                        Margin="0,20,0,0" 
                        Text="Anuluj" 
                        BackgroundColor="{StaticResource Negative}" 
                        Command="{Binding CancelEditCommand}" />

				</Grid>
			</Grid>
		</ScrollView>

		<Grid
            IsVisible="{Binding ShowLoadingIcon}"
            BackgroundColor="#80000000"
            ZIndex="999"
            Padding="50">

			<ActivityIndicator
                IsRunning="{Binding RunLoadingIcon}"
                Color="White"
                WidthRequest="80"
                HeightRequest="80"
                HorizontalOptions="Center"
                VerticalOptions="Center" />
		</Grid>

	</Grid>
</ContentPage>